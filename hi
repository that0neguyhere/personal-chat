--loadstring(game:HttpGet("https://raw.githubusercontent.com/that0neguyhere/personal-chat/refs/heads/main/hi"))()

disablechat = true

if disablechat == true then
	game:GetService('StarterGui'):SetCoreGuiEnabled(Enum.CoreGuiType.Chat, false) -- optional
end

local key = 'X7qvGpL2JzN5mBYKd8RWaVt91CXsMkF6oTZUb3yPH4fwQE0rDgAlShnJxVoLp78' -- think of ts as a lobby twin
local animid = "rbxassetid://17746000371"
local messageLimit = 30  -- adjust to save more msgs or wtv

local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local localplr = Players.LocalPlayer

local function expand(key, length)
	local expanded = {}
	local sum = 0
	for i = 1, length do
		local k = string.byte(key, (i - 1) % #key + 1)
		sum = (sum + k) % 256
		expanded[i] = sum
	end
	return expanded
end

local function encrypt(text, key)
	local ks = expand(key, #text)
	local out = {}
	for i = 1, #text do
		local c = string.byte(text, i)
		local k = ks[i]
		out[i] = string.char((bit32.bxor(c, k) + k) % 256)
	end
	return table.concat(out)
end

local function decrypt(text, key)
	local ks = expand(key, #text)
	local out = {}
	for i = 1, #text do
		local c = string.byte(text, i)
		local k = ks[i]
		out[i] = string.char(bit32.bxor((c - k) % 256, k))
	end
	return table.concat(out)
end

local NAME_COLORS = {
	Color3.fromRGB(253, 41, 67),   -- Red
	Color3.fromRGB(1, 162, 255),   -- Blue
	Color3.fromRGB(2, 184, 87),    -- Green
	Color3.fromRGB(255, 170, 0),   -- Orange
	Color3.fromRGB(170, 85, 255),  -- Purple
	Color3.fromRGB(255, 102, 204), -- Pink
	Color3.fromRGB(0, 143, 156),   -- Teal
}

function nameclr(username)
	username = string.lower(username)
	local sum = 0
	for i = 1, #username do
		sum += string.byte(username, i)
	end
	return NAME_COLORS[(sum % #NAME_COLORS) + 1]
end

local protui = gethui() or cloneref(game:GetService("CoreGui")) or game:GetService("CoreGui") or game:GetService("Players").LocalPlayer.PlayerGui

local sg = Instance.new("ScreenGui", protui)
sg.Name = "ChatHaxZomg"

local frm = Instance.new("Frame", sg)
frm.Size = UDim2.new(0, 300, 0, 220)
frm.Position = UDim2.new(0.5, 0, 0.5, 0)
frm.AnchorPoint = Vector2.new(0.5, 0.5)
frm.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
frm.BorderSizePixel = 0
frm.Active = true
Instance.new("UICorner", frm).CornerRadius = UDim.new(0, 8)

local UIS = game:GetService("UserInputService")
function dragify(Frame)
	dragToggle = nil
	dragSpeed = 0.15
	dragInput = nil
	dragStart = nil
	dragPos = nil
	function updateInput(input)
		Delta = input.Position - dragStart
		Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + Delta.X, startPos.Y.Scale, startPos.Y.Offset + Delta.Y)
		game:GetService("TweenService"):Create(Frame, TweenInfo.new(0.15), {Position = Position}):Play()
	end
	Frame.InputBegan:Connect(function(input)
		if (input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch) and UIS:GetFocusedTextBox() == nil then
			dragToggle = true
			dragStart = input.Position
			startPos = Frame.Position
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then
					dragToggle = false
				end
			end)
		end
	end)
	Frame.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
			dragInput = input
		end
	end)
	game:GetService("UserInputService").InputChanged:Connect(function(input)
		if input == dragInput and dragToggle then
			updateInput(input)
		end
	end)
end
dragify(frm)


local scr = Instance.new("ScrollingFrame", frm)
scr.Size = UDim2.new(1, -16, 1, -60)
scr.Position = UDim2.new(0, 8, 0, 8)
scr.ScrollBarThickness = 5
scr.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
scr.BorderSizePixel = 0
scr.AutomaticCanvasSize = Enum.AutomaticSize.None
Instance.new("UICorner", scr).CornerRadius = UDim.new(0, 6)

local pad = Instance.new("UIPadding", scr)
pad.PaddingTop = UDim.new(0, 6)
pad.PaddingBottom = UDim.new(0, 6)
pad.PaddingLeft = UDim.new(0, 6)
pad.PaddingRight = UDim.new(0, 6)

local layout = Instance.new("UIListLayout", scr)
layout.Padding = UDim.new(0, 6)

layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
	scr.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 10)
	scr.CanvasPosition = Vector2.new(0, math.max(0, scr.CanvasSize.Y.Offset - scr.AbsoluteWindowSize.Y))
end)

local txt = Instance.new("TextBox", frm)
txt.Size = UDim2.new(1, -80, 0, 30)
txt.Position = UDim2.new(0, 8, 1, -38)
txt.Font = Enum.Font.Gotham
txt.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
txt.TextColor3 = Color3.new(1, 1, 1)
txt.TextSize = 14
txt.ClearTextOnFocus = false
txt.PlaceholderText = 'Click or press "." or "/" to chat!'
txt.Text = ""
txt.TextScaled = true
txt.BorderSizePixel = 0
txt.TextXAlignment = Enum.TextXAlignment.Left
Instance.new("UICorner", txt).CornerRadius = UDim.new(0, 6)

local snd = Instance.new("TextButton", frm)
snd.Size = UDim2.new(0, 60, 0, 30)
snd.Position = UDim2.new(1, -68, 1, -38)
snd.Text = "Send"
snd.Font = Enum.Font.Gotham
snd.TextSize = 14
snd.BackgroundColor3 = Color3.fromRGB(70, 130, 255)
snd.TextColor3 = Color3.new(1, 1, 1)
snd.BorderSizePixel = 0
Instance.new("UICorner", snd).CornerRadius = UDim.new(0, 6)

local messages = {}

function msg(plr, msg)
	local holder = Instance.new("Frame")
	holder.Size = UDim2.new(1, -4, 0, 0)
	holder.AutomaticSize = Enum.AutomaticSize.Y
	holder.BackgroundTransparency = 1
	holder.Parent = scr

	local hLayout = Instance.new("UIListLayout", holder)
	hLayout.FillDirection = Enum.FillDirection.Horizontal
	hLayout.Padding = UDim.new(0, 4)

	local nameLabel = Instance.new("TextLabel")
	nameLabel.BackgroundTransparency = 1
	nameLabel.AutomaticSize = Enum.AutomaticSize.XY
	nameLabel.Font = Enum.Font.GothamBold
	nameLabel.TextSize = 14
	nameLabel.TextXAlignment = Enum.TextXAlignment.Left
	nameLabel.TextYAlignment = Enum.TextYAlignment.Top

	nameLabel.Text = plr.DisplayName .. " (" .. plr.Name .. "):"
	nameLabel.TextColor3 = nameclr(plr.Name)

	nameLabel.Parent = holder

	local msgLabel = Instance.new("TextLabel")
	msgLabel.BackgroundTransparency = 1
	msgLabel.Size = UDim2.new(1, -nameLabel.AbsoluteSize.X - 6, 0, 0)
	msgLabel.AutomaticSize = Enum.AutomaticSize.Y
	msgLabel.TextWrapped = true
	msgLabel.Font = Enum.Font.Gotham
	msgLabel.TextSize = 14
	msgLabel.TextColor3 = Color3.new(1, 1, 1)
	msgLabel.TextXAlignment = Enum.TextXAlignment.Left
	msgLabel.TextYAlignment = Enum.TextYAlignment.Top
	msgLabel.Text = msg
	msgLabel.Parent = holder

	table.insert(messages, holder)
	if #messages > messageLimit then
		messages[1]:Destroy()
		table.remove(messages, 1)
	end
end

snd.MouseButton1Down:Connect(function()
	if txt.Text == "" then return end

	local encrypted = encrypt(txt.Text, key)
	txt.Text = ""

	local anim = Instance.new("Animation")
	anim.AnimationId = animid .. encrypted
	localplr.Character.Humanoid:LoadAnimation(anim):Play()
end)

UIS.InputBegan:Connect(function(input, gp)
	if gp then return end

	if input.KeyCode == Enum.KeyCode.Period or input.KeyCode == Enum.KeyCode.Slash then
		txt:CaptureFocus()
	end
end)


UIS.InputBegan:Connect(function(input, gp)
	if gp then return end

	if input.KeyCode == Enum.KeyCode.Period or input.KeyCode == Enum.KeyCode.Slash then
		txt:CaptureFocus()
	elseif input.KeyCode == Enum.KeyCode.KeypadEnter then
		
	end
end)

local function hookHumanoid(player, hum)
	hum.AnimationPlayed:Connect(function(track)
		local id = track.Animation.AnimationId
		if id:sub(1, #animid) == animid then
			local payload = id:sub(#animid + 1)
			msg(player, decrypt(payload, key))
		end
	end)
end

for _, plr in ipairs(Players:GetPlayers()) do
	if plr.Character and plr.Character:FindFirstChild("Humanoid") then
		hookHumanoid(plr, plr.Character.Humanoid)
	end
	plr.CharacterAdded:Connect(function(c)
		hookHumanoid(plr, c:WaitForChild("Humanoid"))
	end)
end
