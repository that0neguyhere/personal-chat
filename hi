--[[
TODO:
1. make a toggle button for chat so if you want to talk in actual chat to someone who actually can see and send messages in your age group you can toggle the actual chat
2. check out source code for nameless admin by itseverydayyou to see how to make a gui not detected by most anti cheats
3. if adding images learn how to use the getcustomasset exploit function if available on the executor else fallback to image id (prevents coregui checking through image ids that aren't originally in coregui these types of checks are usually found in anti cheats)
4. add custom commands c/linkcmds (runs my linked cmds which i will update to be able to be used with this soon) c/me/<message> (literaly just the classic /me <message> command brought back because it was pretty funny to use and see back then) c/help (displays all commands etc) c/rj,rejoin (makes you rejoin the server) c/sh,shop,serverhop (makes you server hop into a different server (check nameless admin source code to learn how to properly make this work)) c/laugh (uses ugc emotes so r15 only) c/point (uses ugc emotes so r15 only) c/fling/<playername> (just flings a player because why not) c/sit (makes you sit) etc
<num>. add more todo list stuff if you want
]]

--loadstring(game:HttpGet("https://raw.githubusercontent.com/that0neguyhere/personal-chat/refs/heads/main/hi"))()

--[[
Awesome & ca3r's Age Verification Bypasser Version 1.0.1.
Commands exist now.

type "/e random" for a random emote. (this includes the laughing, waving, cheering and laughing emotes.)

--DANCES

type "/e dance1" for the first dance.
type "/e dance2" for the second dance.
type "/e dance3" for the third dance.

--EXPRESSIONS

vvv these ones loop too!
type "/e wave" to wave at people.
type "/e cheer" to cheer for someone.
type "/e point" to point at something.
type "/e laugh" to bully someone.
^^^ these ones loop too!

--ADJUSTMENTS

type "/clear" to clear the whole chat.
type "/spd [number]" near the emotes to adjust the speed.
]]

disablechat = true

local cloneref = cloneref or function(...) return ... end

local STG = cloneref(game:GetService("StarterGui"))

if disablechat == true then -- instead of doing this add an option to toggle chat in the gui
	--STG:SetCoreGuiEnabled(Enum.CoreGuiType.Chat, false) -- optional
end

local key = 'X7qvGpL2JzN5mBYKd8RWaVt91CXsMkF6oTZUb3yPH4fwQE0rDgAlShnJxVoLp78' -- think of ts as a lobby twin
local animid = "rbxassetid://17746000371"
local messageLimit = 500  -- adjust to save more msgs or wtv (this is a better number so the chat history isnt too long or too short because 30 was way too short and seeing most chat messages is key if someone forgets a ton like me - e god)

local Players = cloneref(game:GetService("Players"))
local UIS = cloneref(game:GetService("UserInputService"))
local localplr = Players.LocalPlayer

local function expand(key, length)
	local expanded = {}
	local sum = 0
	for i = 1, length do
		local k = string.byte(key, (i - 1) % #key + 1)
		sum = (sum + k) % 256
		expanded[i] = sum
	end
	return expanded
end

local function encrypt(text, key)
	local ks = expand(key, #text)
	local out = {}
	for i = 1, #text do
		local c = string.byte(text, i)
		local k = ks[i]
		out[i] = string.char((bit32.bxor(c, k) + k) % 256)
	end
	return table.concat(out)
end

local function decrypt(text, key)
	local ks = expand(key, #text)
	local out = {}
	for i = 1, #text do
		local c = string.byte(text, i)
		local k = ks[i]
		out[i] = string.char(bit32.bxor((c - k) % 256, k))
	end
	return table.concat(out)
end

local NAME_COLORS = {
	Color3.fromRGB(253, 41, 67),   -- Red
	Color3.fromRGB(1, 162, 255),   -- Blue
	Color3.fromRGB(2, 184, 87),    -- Green
	Color3.fromRGB(255, 170, 0),   -- Orange
	Color3.fromRGB(170, 85, 255),  -- Purple
	Color3.fromRGB(255, 102, 204), -- Pink
	Color3.fromRGB(0, 143, 156),   -- Teal
}

function nameclr(n)
	n=n:lower()
	local s=0
	for i=1,#n do s+=string.byte(n,i) end
	return NAME_COLORS[(s%#NAME_COLORS)+1]
end

local protui=(gethui and gethui()) or cloneref(game:GetService("CoreGui")) or cloneref(localplr:WaitForChild("PlayerGui"))

local sg=Instance.new("ScreenGui")
sg.Name=tostring(math.random())
sg.Parent=protui

local frm=Instance.new("Frame")
frm.Size = UDim2.new(0, 300, 0, 260)
frm.Position=UDim2.new(0.5,0,0.5,0)
frm.AnchorPoint=Vector2.new(0.5,0.5)
frm.BackgroundColor3=Color3.fromRGB(20,20,20)
frm.BorderSizePixel=0
frm.Active=true
frm.Parent=sg

local dragify = Instance.new("UIDragDetector") -- changed to this since its latest roblox tech (add back actual function because i messed up and removed it due to not thinking it could be used after this when obviously it can be used for the delta-like button)
dragify.Parent = frm

Instance.new("UICorner",frm).CornerRadius=UDim.new(0,8)

local title=Instance.new("TextLabel")
title.Size = UDim2.new(0, 180, 0,28)
title.Position=UDim2.new(0,10,0,6)
title.BackgroundTransparency=1
title.BorderSizePixel=0
title.Active=true
title.TextColor3=Color3.new(1,1,1)
title.Font=Enum.Font.GothamBold
title.TextScaled=true
title.Text="Awesome & ca3r's epic chat"
title.TextXAlignment=Enum.TextXAlignment.Left
title.Parent=frm

local scr=Instance.new("ScrollingFrame")
scr.Size = UDim2.new(1, -16, 1, -85)
scr.Position = UDim2.new(0, 8, 0, 40)
scr.ScrollBarThickness=5
scr.BackgroundColor3=Color3.fromRGB(30,30,30)
scr.BorderSizePixel=0
scr.AutomaticCanvasSize=Enum.AutomaticSize.None
scr.Parent=frm

Instance.new("UICorner",scr).CornerRadius=UDim.new(0,6)

local pad=Instance.new("UIPadding",scr)
pad.PaddingTop=UDim.new(0,6)
pad.PaddingBottom=UDim.new(0,6)
pad.PaddingLeft=UDim.new(0,6)
pad.PaddingRight=UDim.new(0,6)

local layout=Instance.new("UIListLayout",scr)
layout.Padding=UDim.new(0,6)

layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
	scr.CanvasSize=UDim2.new(0,0,0,layout.AbsoluteContentSize.Y+10)
	scr.CanvasPosition=Vector2.new(0,math.max(0,scr.CanvasSize.Y.Offset-scr.AbsoluteWindowSize.Y))
end)

local txt=Instance.new("TextBox",frm)
txt.Size=UDim2.new(1,-80,0,30)
txt.Position=UDim2.new(0,8,1,-38)
txt.Font=Enum.Font.Gotham
txt.BackgroundColor3=Color3.fromRGB(40,40,40)
txt.TextColor3=Color3.new(1,1,1)
txt.TextSize=14
txt.ClearTextOnFocus=false
txt.PlaceholderText='Click or press "." or "/" to chat!'
txt.Text=""
txt.TextScaled=true
txt.BorderSizePixel=0
txt.TextXAlignment=Enum.TextXAlignment.Left
Instance.new("UICorner",txt).CornerRadius=UDim.new(0,6)

local snd=Instance.new("TextButton",frm)
snd.Size=UDim2.new(0,60,0,30)
snd.Position=UDim2.new(1,-68,1,-38)
snd.Text="Send"
snd.Font=Enum.Font.Gotham
snd.TextSize=14
snd.BackgroundColor3=Color3.fromRGB(70,130,255)
snd.TextColor3=Color3.new(1,1,1)
snd.BorderSizePixel=0
Instance.new("UICorner",snd).CornerRadius=UDim.new(0,6)

local min=Instance.new("TextButton",frm)
min.Size=UDim2.new(0,28,0,28)
min.Position=UDim2.new(1,-68,0,6)
min.Text="-"
min.Font=Enum.Font.GothamBold
min.TextSize=20
min.BackgroundColor3=Color3.fromRGB(35,35,35)
min.TextColor3=Color3.new(1,1,1)
Instance.new("UICorner",min).CornerRadius=UDim.new(0,4)

local close=Instance.new("TextButton",frm)
close.Size=UDim2.new(0,28,0,28)
close.Position=UDim2.new(1,-34,0,6)
close.Text="X"
close.Font=Enum.Font.GothamBold
close.TextSize=14
close.BackgroundColor3=Color3.fromRGB(200,55,55)
close.TextColor3=Color3.new(1,1,1)
Instance.new("UICorner",close).CornerRadius=UDim.new(0,4)

function closegui() sg:Destroy() end
close.MouseButton1Click:Connect(closegui)

local open=Instance.new("TextButton",sg)
open.Size=UDim2.new(0,60,0,30)
open.Position=UDim2.new(0,20,0.5,0)
open.Text="Chat"
open.Font=Enum.Font.GothamBold
open.TextSize=14
open.BackgroundColor3=Color3.fromRGB(35,35,35)
open.TextColor3=Color3.new(1,1,1)
open.BorderSizePixel=0
open.Visible=false
Instance.new("UICorner",open).CornerRadius=UDim.new(0,6)

local UIS = game:GetService("UserInputService")
function dragify(Frame)
	dragToggle = nil
	dragSpeed = 0.15
	dragInput = nil
	dragStart = nil
	dragPos = nil
	function updateInput(input)
		Delta = input.Position - dragStart
		Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + Delta.X, startPos.Y.Scale, startPos.Y.Offset + Delta.Y)
		game:GetService("TweenService"):Create(Frame, TweenInfo.new(0.15), {Position = Position}):Play()
	end
	Frame.InputBegan:Connect(function(input)
		if (input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch) and UIS:GetFocusedTextBox() == nil then
			dragToggle = true
			dragStart = input.Position
			startPos = Frame.Position
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then
					dragToggle = false
				end
			end)
		end
	end)
	Frame.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
			dragInput = input
		end
	end)
	game:GetService("UserInputService").InputChanged:Connect(function(input)
		if input == dragInput and dragToggle then
			updateInput(input)
		end
	end)
end
dragify(open)

function mingui() frm.Visible=false; open.Visible=true end
function restore() frm.Visible=true; open.Visible=false end

min.MouseButton1Click:Connect(mingui)
open.MouseButton1Click:Connect(restore)

local TS = cloneref(game:GetService("TweenService"))

local voiceon = true
local voice = Instance.new("ImageButton", frm)
voice.Size = UDim2.new(0, 28, 0, 28)
voice.Position = UDim2.new(1, -102, 0, 6)
voice.Image = "rbxassetid://729923345"
voice.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
voice.BorderSizePixel = 0
Instance.new("UICorner", voice).CornerRadius = UDim.new(0, 4)

function togglev()
	voiceon = not voiceon
	if voiceon then
		voice.ImageColor3 = Color3.new(1, 1, 1)
	else
		TS:Create(voice, TweenInfo.new(0.25), {ImageColor3 = Color3.fromRGB(255,0,0)}):Play()
	end
end
voice.MouseButton1Click:Connect(togglev)

local crn3 = Instance.new("UICorner")
crn3.CornerRadius = UDim.new(0, 6)
crn3.Parent = snd

local messages = {}

function msg(plr, message)
	local holder = Instance.new("Frame")
	holder.Size = UDim2.new(1, -4, 0, 0)
	holder.AutomaticSize = Enum.AutomaticSize.Y
	holder.BackgroundTransparency = 1
	holder.Parent = scr

	local hLayout = Instance.new("UIListLayout")
	hLayout.FillDirection = Enum.FillDirection.Horizontal
	hLayout.Padding = UDim.new(0, 4)
	hLayout.Parent = holder

	local nameLabel = Instance.new("TextLabel")
	nameLabel.BackgroundTransparency = 1
	nameLabel.AutomaticSize = Enum.AutomaticSize.XY
	nameLabel.Font = Enum.Font.GothamBold
	nameLabel.TextSize = 14
	nameLabel.TextXAlignment = Enum.TextXAlignment.Left
	nameLabel.TextYAlignment = Enum.TextYAlignment.Top
	nameLabel.Text = plr.DisplayName .. "(@" .. plr.Name .. "):"
	nameLabel.TextColor3 = nameclr(plr.Name)
	nameLabel.Parent = holder

	local msgLabel = Instance.new("TextLabel")
	msgLabel.BackgroundTransparency = 1
	msgLabel.Size = UDim2.new(1, -nameLabel.AbsoluteSize.X - 6, 0, 0)
	msgLabel.AutomaticSize = Enum.AutomaticSize.Y
	msgLabel.TextWrapped = true
	msgLabel.Font = Enum.Font.Gotham
	msgLabel.TextSize = 14
	msgLabel.TextColor3 = Color3.new(1, 1, 1)
	msgLabel.TextXAlignment = Enum.TextXAlignment.Left
	msgLabel.TextYAlignment = Enum.TextYAlignment.Top
	msgLabel.Text = ""
	msgLabel.Parent = holder
	
	spawn(function()
		local sound = Instance.new("Sound")
		sound.SoundId = "rbxassetid://2347859197"
		sound.Volume = 1
		sound.Parent = msgLabel

		for i = 1, #message do
			msgLabel.Text = message:sub(1, i)
			if voiceon == true then
				sound:Play()
			end
			task.wait(0.05)
		end

		sound:Destroy()
	end)

	table.insert(messages, holder)
	if #messages > messageLimit then
		messages[1]:Destroy()
		table.remove(messages, 1)
	end
end

function setanim(char, state)
	local animate = char:FindFirstChild("Animate")
	if animate then
		animate.Disabled = not state
	end
end

function prsspd(text)
	local speed = 1
	local spd = string.match(text, "/spd%s*([%d%.%-]+)")
	if spd then
		local n = tonumber(spd)
		if n and n > 0 then
			speed = n
		end
	end
	return speed
end

function strspd(text)
	return (string.gsub(text, "/spd%s*[%d%.%-]+", "")):gsub("%s+$", "")
end

function clrchat()
	for _, msgFrame in ipairs(messages) do
		if msgFrame and msgFrame.Parent then
			msgFrame:Destroy()
		end
	end
	table.clear(messages)
	scr.CanvasPosition = Vector2.new(0, 0)
end

snd.MouseButton1Down:Connect(function()
	local Char = localplr.Character
	if not Char then return end

	local hum = Char:FindFirstChildOfClass("Humanoid")
	if not hum or txt.Text == "" then return end

	local rawText = txt.Text
	local speed = prsspd(rawText)
	local text = strspd(rawText)

	setanim(Char, true)
	
	if text == "/clear" then
		clrchat()
		txt.Text = ""
		return
	end
	
	if hum.RigType == Enum.HumanoidRigType.R6 then
		local danceId

		local R6_EMOTES = {
			"rbxassetid://132546884",
			"rbxassetid://160934376",
			"rbxassetid://160934593",
			"rbxassetid://128777973",
			"rbxassetid://129423030",
			"rbxassetid://128853357",
			"rbxassetid://129423131",
		}

		if text == "/e random" then
			danceId = R6_EMOTES[math.random(#R6_EMOTES)]
		elseif text == "/e dance1" then
			danceId = R6_EMOTES[1]
		elseif text == "/e dance2" then
			danceId = R6_EMOTES[2]
		elseif text == "/e dance3" then
			danceId = R6_EMOTES[3]
		elseif text == "/e wave" then
			danceId = R6_EMOTES[4]
		elseif text == "/e cheer" then
			danceId = R6_EMOTES[5]
		elseif text == "/e point" then
			danceId = R6_EMOTES[6]
		elseif text == "/e laugh" then
			danceId = R6_EMOTES[7]
		end

		if danceId then
			setanim(Char, false)

			for _, v in ipairs(hum:GetPlayingAnimationTracks()) do
				v:Stop(0)
			end

			local anim = Instance.new("Animation")
			anim.AnimationId = danceId

			local playing = true
			local track

			local function play()
				if not playing then return end
				track = hum:LoadAnimation(anim)
				track.Priority = Enum.AnimationPriority.Action
				track:Play()
				track:AdjustSpeed(speed)

				track.Stopped:Once(function()
					if playing then
						play()
					end
				end)
			end

			play()

			local function stop()
				if not playing then return end
				playing = false
				if track then
					track:Stop()
				end
				setanim(Char, true)
			end

			hum.Running:Connect(function(s)
				if s > 0 then
					stop()
				end
			end)

			hum.Jumping:Connect(stop)

			return
		end
	end

	for _, v in ipairs(hum:GetPlayingAnimationTracks()) do
		v:Stop(0)
	end

	setanim(Char, true)

	local encrypted = encrypt(text, key)
	local anim = Instance.new("Animation")
	anim.AnimationId = animid .. encrypted

	local track = hum:LoadAnimation(anim)
	track.Priority = Enum.AnimationPriority.Action
	track:Play()
end)

local RSV = cloneref(game:GetService("RunService"))

UIS.InputBegan:Connect(function(input, gp)
	if gp then return end

	if input.KeyCode == Enum.KeyCode.Period or input.KeyCode == Enum.KeyCode.Slash then -- why use the keys that roblox uses for emotes and normal chat
		RSV.RenderStepped:Wait()
		txt:CaptureFocus()
	elseif input.KeyCode == Enum.KeyCode.KeypadEnter then
		if txt.Text == "" then return end

		local encrypted = encrypt(txt.Text, key)
		txt.Text = ""

		local anim = Instance.new("Animation")
		anim.AnimationId = animid .. encrypted
		localplr.Character.Humanoid:LoadAnimation(anim):Play()
	end
end)

local function hookHumanoid(player, hum)
	hum.AnimationPlayed:Connect(function(track)
		local id = track.Animation.AnimationId
		if id:sub(1, #animid) == animid then
			local payload = id:sub(#animid + 1)
			msg(player, decrypt(payload, key))
		end
	end)
end

Players.PlayerAdded:Connect(function(plr) -- bro who makes a script that grabs players for stuff like this but not grab newly joining players - e god
	plr.CharacterAdded:Connect(function(c)
		repeat
			task.wait(0.1)
		until c:FindFirstChildWhichIsA("Humanoid",true) ~= nil
		hookHumanoid(plr, c:FindFirstChildWhichIsA("Humanoid",true))
	end)
end)

for _, plr in ipairs(Players:GetPlayers()) do
	if plr.Character then
		local hum = plr.Character:FindFirstChildWhichIsA("Humanoid", true)
		if hum then
			hookHumanoid(plr, hum)
		end
	end
	plr.CharacterAdded:Connect(function(c)
		local hum
		repeat
			task.wait(0.1)
			hum = c:FindFirstChildWhichIsA("Humanoid", true)
		until hum

		hookHumanoid(plr, hum)
	end)
end
